"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{51103:function(Y,P,e){e.r(P),e.d(P,{default:function(){return L}});var R=e(15009),o=e.n(R),D=e(99289),y=e.n(D),N=e(5574),b=e.n(N),z=e(74273),A=e(90930),H=e(38345),G=e(51390),v=e(67294),K=e(97857),M=e.n(K),T=e(66309),C=e(59530),B=function(){return(0,C.request)("/easy-flowable/processInstance/statics")},F=function(n){return(0,C.request)("/easy-flowable/processInstance/todoTaskPage",{method:"POST",data:n})},g=[{title:"\u6D41\u7A0B\u540D\u79F0",dataIndex:"processName"},{title:"\u8282\u70B9\u540D\u79F0",dataIndex:"nodeName"},{title:"\u5F00\u59CB\u65F6\u95F4",dataIndex:"startTime"}],$=[{title:"\u7ED3\u675F\u65F6\u95F4",dataIndex:"endTime"},{title:"\u6D41\u7A0B\u72B6\u6001",dataIndex:"status",align:"center",render:function(n,t,u){return t.status===1?v.createElement(T.Z,{color:"success"},"\u5DF2\u5B8C\u6210"):t.status===2?v.createElement(T.Z,{color:"red"},"\u5DF2\u4F5C\u5E9F"):v.createElement(T.Z,{color:"processing"},"\u8FDB\u884C\u4E2D")}}],O=function(){var i=y()(o()().mark(function n(){var t,u,f;return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,B();case 2:if(t=r.sent,u=t.success,f=t.result,!u){r.next=7;break}return r.abrupt("return",f);case 7:return r.abrupt("return",!1);case 8:case"end":return r.stop()}},n)}));return function(){return i.apply(this,arguments)}}(),U=function(){var i=y()(o()().mark(function n(t){var u,f,m;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,F(M()({},t));case 2:return u=l.sent,f=u.success,m=u.result,l.abrupt("return",{success:f,total:m.total||0,data:m.records||[]});case 6:case"end":return l.stop()}},n)}));return function(t){return i.apply(this,arguments)}}(),k=[{key:"todo",title:"\u5F85\u529E",status:"processing",value:10,columns:g,total:!0},{key:"done",title:"\u5DF2\u529E",status:"success",value:5,columns:g.concat($),total:!0},{key:"meTodo",title:"\u6211\u7684\u5F85\u529E",status:"default",value:1,columns:g},{key:"meDone",title:"\u6211\u7684\u5DF2\u529E",status:"default",value:1,columns:g.concat($)}],x=e(60849),W=e(78957),d=e(85893),w=z.Z.Statistic,J=function(){var n=(0,C.useModel)("@@initialState"),t=n.initialState,u=t.users,f=t.groups,m=v.useRef(),r=v.useState(k),l=b()(r,2),Q=l[0],V=l[1],X=function(p){return[{title:"\u5F85\u529E\u4EBA",dataIndex:"assignee",hideInTable:p.startsWith("me"),valueType:"select",request:function(){var I=y()(o()().mark(function c(){return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",u);case 1:case"end":return s.stop()}},c)}));function S(){return I.apply(this,arguments)}return S}()},{title:"\u6D41\u7A0B\u53D1\u8D77\u4EBA",dataIndex:"startUserId",valueType:"select",request:function(){var I=y()(o()().mark(function c(){return o()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",u);case 1:case"end":return s.stop()}},c)}));function S(){return I.apply(this,arguments)}return S}()},{title:"\u64CD\u4F5C",hideInTable:p==="todo",align:"center",render:function(S,c){var h=c.comments,s=c.nodeName,Z=c.processInstanceId,E=c.taskId;return(0,d.jsxs)(W.Z,{children:[h&&h.length?(0,d.jsx)(x.K,{form:!1,comments:h,taskName:s}):null,E&&Z?(0,d.jsx)(x.z,{link:!0,processInstanceId:Z,taskId:E,reload:function(){var j;return(j=m.current)===null||j===void 0?void 0:j.reloadAndRest()}}):null]})}}]};return v.useEffect(function(){O().then(function(a){a&&V(k.filter(function(p){return p.value=a[p.key],!0}))})},[]),(0,d.jsx)(A._z,{title:"\u9996\u9875\u7EDF\u8BA1",children:(0,d.jsx)(H.Z,{tabs:{items:Q.map(function(a){return{key:a.key,style:{width:"100%"},label:(0,d.jsx)(w,{layout:"vertical",title:a.title,value:a.value,status:a.status,style:{width:120,borderInlineEnd:a.total?"1px solid #f0f0f0":void 0}}),children:(0,d.jsx)(G.Z,{search:!1,size:"small",request:U,params:{params:a.key},pagination:{defaultPageSize:10},scroll:{y:450},rowKey:"id",columns:a.columns.concat(X(a.key))})}})}})})},L=J}}]);
