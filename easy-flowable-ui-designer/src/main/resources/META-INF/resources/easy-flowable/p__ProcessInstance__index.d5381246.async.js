"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[88],{86615:function(_,D,e){var v=e(1413),x=e(91),B=e(22270),s=e(78045),O=e(67294),Z=e(83607),y=e(31649),U=e(85893),p=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],A=O.forwardRef(function(f,I){var K=f.fieldProps,W=f.options,M=f.radioType,m=f.layout,z=f.proFieldProps,a=f.valueEnum,S=(0,x.Z)(f,p);return(0,U.jsx)(y.Z,(0,v.Z)((0,v.Z)({valueType:M==="button"?"radioButton":"radio",ref:I,valueEnum:(0,B.h)(a,void 0)},S),{},{fieldProps:(0,v.Z)({options:W,layout:m},K),proFieldProps:z,filedConfig:{customLightMode:!0}}))}),L=O.forwardRef(function(f,I){var K=f.fieldProps,W=f.children;return(0,U.jsx)(s.ZP,(0,v.Z)((0,v.Z)({},K),{},{ref:I,children:W}))}),$=(0,Z.G)(L,{valuePropName:"checked",ignoreWidth:!0}),T=$;T.Group=A,T.Button=s.ZP.Button,T.displayName="ProFormComponent",D.Z=T},90672:function(_,D,e){var v=e(1413),x=e(91),B=e(67294),s=e(31649),O=e(85893),Z=["fieldProps","proFieldProps"],y=function(p,A){var L=p.fieldProps,$=p.proFieldProps,T=(0,x.Z)(p,Z);return(0,O.jsx)(s.Z,(0,v.Z)({ref:A,valueType:"textarea",fieldProps:L,proFieldProps:$},T))};D.Z=B.forwardRef(y)},32443:function(_,D,e){e.d(D,{Z:function(){return m}});var v=e(1413),x=e(91),B=e(87462),s=e(67294),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},Z=O,y=e(84089),U=function(a,S){return s.createElement(y.Z,(0,B.Z)({},a,{ref:S,icon:Z}))},p=s.forwardRef(U),A=p,L=e(31365),$=e(14726),T=e(9105),f=e(83607),I=e(85893),K=["fieldProps","action","accept","listType","title","max","icon","buttonProps","disabled","proFieldProps"],W=function(a,S){var b,l=a.fieldProps,H=a.action,Q=a.accept,r=a.listType,w=a.title,R=w===void 0?"\u5355\u51FB\u4E0A\u4F20":w,h=a.max,d=a.icon,i=d===void 0?(0,I.jsx)(A,{}):d,g=a.buttonProps,F=a.disabled,E=a.proFieldProps,n=(0,x.Z)(a,K),G=(0,s.useMemo)(function(){var C;return(C=n.fileList)!==null&&C!==void 0?C:n.value},[n.fileList,n.value]),k=(0,s.useContext)(T.A),X=(E==null?void 0:E.mode)||k.mode||"edit",ee=(h===void 0||!G||(G==null?void 0:G.length)<h)&&X!=="read",re=(r!=null?r:l==null?void 0:l.listType)==="picture-card";return(0,I.jsx)(L.Z,(0,v.Z)((0,v.Z)({action:H,accept:Q,ref:S,listType:r||"picture",fileList:G},l),{},{name:(b=l==null?void 0:l.name)!==null&&b!==void 0?b:"file",onChange:function(ne){var c;l==null||(c=l.onChange)===null||c===void 0||c.call(l,ne)},children:ee&&(re?(0,I.jsxs)("span",{children:[i," ",R]}):(0,I.jsxs)($.ZP,(0,v.Z)((0,v.Z)({disabled:F||(l==null?void 0:l.disabled)},g),{},{children:[i,R]})))}))},M=(0,f.G)(s.forwardRef(W),{getValueFromEvent:function(a){return a.fileList}}),m=M},35169:function(_,D,e){e.r(D),e.d(D,{default:function(){return w}});var v=e(97857),x=e.n(v),B=e(15009),s=e.n(B),O=e(99289),Z=e.n(O),y=e(5574),U=e.n(y),p=e(67294),A=e(59530),L=e(184),$=e(37476),T=e(90672),f=e(7529),I=e(88859),K=e(90930),W=e(51390),M=e(71613),m=e(66309),z=function(){var R=Z()(s()().mark(function h(d){var i,g,F;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(d.processDefinitionId){n.next=2;break}return n.abrupt("return",{success:!1,data:[]});case 2:return n.next=4,(0,M.pb)(d.processDefinitionId);case 4:return i=n.sent,g=i.success,F=i.result,n.abrupt("return",{success:g,data:F||[]});case 8:case"end":return n.stop()}},h)}));return function(d){return R.apply(this,arguments)}}(),a=function(){var R=Z()(s()().mark(function h(d){var i,g,F;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,M.Ud)(d.processInstanceId);case 2:return i=n.sent,g=i.success,F=i.result,n.abrupt("return",{success:g,data:F||[]});case 6:case"end":return n.stop()}},h)}));return function(d){return R.apply(this,arguments)}}(),S=function(h){return[{valueType:"index",title:"\u5E8F\u53F7",width:60},{dataIndex:"name",title:"\u5B9E\u4F8B\u540D\u79F0",width:160,ellipsis:!0},{dataIndex:"businessKey",align:"center",title:"\u4E1A\u52A1\u4E3B\u952E",width:140,ellipsis:!0},{dataIndex:"startUserId",align:"center",title:"\u53D1\u8D77\u4EBA",width:120,valueType:"select",request:function(){return h}},{dataIndex:"processInstanceVersion",title:"\u6D41\u7A0B\u5B9E\u4F8B\u8FD0\u884C\u7248\u672C",align:"center",render:function(i){return p.createElement(m.Z,{color:"success"},"V "+i)}},{dataIndex:"businessKeyStatus",align:"center",ellipsis:!0,title:"\u4E1A\u52A1\u72B6\u6001"},{dataIndex:"status",title:"\u6D41\u7A0B\u5B9E\u4F8B\u72B6\u6001",align:"center",width:120,render:function(i,g){var F=g.status;return p.createElement(m.Z,{color:F?"red":"success"},F?"\u6302\u8D77":"\u6FC0\u6D3B")}}]},b=e(78957),l=e(14726),H=e(26412),Q=e(60849),r=e(85893),w=function(){var R=(0,A.useModel)("@@initialState"),h=R.initialState,d=p.useRef(),i=h.users,g=h.groups,F=(0,A.useLocation)(),E=F.state,n=p.useRef(),G=p.useState(!1),k=U()(G,2),X=k[0],ee=k[1];p.useEffect(function(){if(!X){var C;(C=n.current)===null||C===void 0||C.reloadAndRest()}},[X]);var re=[{title:"\u64CD\u4F5C",align:"center",render:function(ne,c){return(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(l.ZP,{onClick:Z()(s()().mark(function N(){var j,o,t;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,M.xg)(c.processInstanceId);case 2:j=u.sent,o=j.success,o&&((t=n.current)===null||t===void 0||t.reloadAndRest());case 5:case"end":return u.stop()}},N)})),style:{color:c.status?"#87d068":"#ff4d4f"},type:"text",children:c.status?"\u6FC0\u6D3B":"\u6302\u8D77"}),(0,r.jsx)(L.a,{title:c.name,open:X,onOpenChange:function(){var j;return(j=n.current)===null||j===void 0?void 0:j.reloadAndRest()},drawerProps:{destroyOnClose:!0},submitter:{resetButtonProps:!1,searchConfig:{submitText:"\u6267\u884C"},render:function(j,o){return(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(Q.z,x()(x()({},c),{},{reload:function(){var P,u;(P=n.current)===null||P===void 0||P.reloadAndRest(),(u=d.current)===null||u===void 0||u.reloadAndRest()}})),(0,r.jsx)($.Y,{width:"25%",onFinish:function(){var t=Z()(s()().mark(function P(u){var V,te,J;return s()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,(0,M.t8)(x()(x()({},u),{},{flowCommentType:"CANCELLATION",processInstanceId:c.processInstanceId,taskId:c.taskId}));case 2:return te=Y.sent,J=te.success,ee(!1),(V=n.current)===null||V===void 0||V.reloadAndRest(),Y.abrupt("return",J);case 7:case"end":return Y.stop()}},P)}));return function(P){return t.apply(this,arguments)}}(),trigger:(0,r.jsx)(l.ZP,{disabled:c.status||!c.taskId,type:"primary",danger:!0,children:"\u6D41\u7A0B\u4F5C\u5E9F"}),children:(0,r.jsx)(T.Z,{name:"commentContent",label:"\u4F5C\u5E9F\u539F\u56E0",rules:[{required:!0,message:"\u4F5C\u5E9F\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"}]})})]})}},trigger:(0,r.jsx)(l.ZP,{type:"text",style:{color:"purple"},children:"\u6267\u884C\u5386\u53F2"}),children:(0,r.jsx)(f.Rs,{grid:{column:1},actionRef:d,params:{processInstanceId:c.processInstanceId},metas:{avatar:{render:function(j,o){var t=o.duration,P=o.assignee;if(t||t===0){if(t<1e3)return(0,r.jsxs)(m.Z,{color:"success",children:["\u8017\u65F6\uFF1A",t,"\u6BEB\u79D2"]});if(t>=1e3&&t<60*1e3)return(0,r.jsxs)(m.Z,{color:"success",children:["\u8017\u65F6\uFF1A",t/1e3,"\u79D2"]});if(t>=60*1e3&&t<60*60*1e3)return(0,r.jsxs)(m.Z,{color:"success",children:["\u8017\u65F6\uFF1A",(t/(60*1e3)).toFixed(0),"\u5206\u949F"]});if(t>=60*60*1e3&&t<24*60*60*1e3)return(0,r.jsxs)(m.Z,{color:"success",children:["\u8017\u65F6\uFF1A",(t/(60*60*1e3)).toFixed(2),"\u5C0F\u65F6"]});if(t>=24*60*60*1e3)return(0,r.jsxs)(m.Z,{color:"warning",children:["\u8017\u65F6\uFF1A",(t/(24*60*60*1e3)).toFixed(2),"\u5929"]})}return(0,r.jsx)(m.Z,{color:"orange",children:P?"\u5F85\u529E":"\u4EFB\u52A1\u5F85\u7B7E\u6536"})}},title:{dataIndex:"taskName"},subTitle:{dataIndex:"assignee",render:function(j,o){var t=o.assignee,P=o.candidateUsers,u=o.candidateGroups;return u&&u.length?(0,r.jsxs)(m.Z,{color:"purple",children:["\u5019\u9009\u7EC4:",(0,r.jsx)(I.Ju,{text:u,mode:"read",request:function(){return g}})]}):(0,r.jsxs)(m.Z,{color:"purple",children:[t?"\u6267\u884C\u4EBA: ":"\u5019\u9009\u4EBA: ",(0,r.jsx)(I.Ju,{text:t!=null?t:P,mode:"read",request:function(){return i}})]})}},content:{render:function(j,o){return(0,r.jsxs)(H.Z,{column:3,children:[(0,r.jsx)(H.Z.Item,{label:"\u4EFB\u52A1\u8282\u70B9",children:o.taskDefKey}),(0,r.jsx)(H.Z.Item,{label:"\u5F00\u59CB\u65F6\u95F4",children:o.startTime}),(0,r.jsx)(H.Z.Item,{label:"\u7ED3\u675F\u65F6\u95F4",children:o.endTime})]})}},actions:{render:function(j,o){var t=o.comments,P=o.taskName,u=o.taskId,V=o.endTime;return(0,r.jsxs)(b.Z,{children:[t&&t.length?(0,r.jsx)(Q.K,{comments:t,taskName:P}):null,c.taskIds&&!V?(0,r.jsx)(Q.z,x()(x()({},c),{},{link:!0,taskId:u,reload:function(){var J,q;(J=n.current)===null||J===void 0||J.reloadAndRest(),(q=d.current)===null||q===void 0||q.reloadAndRest()}})):null]})}}},rowKey:"historyId",request:a})})]})}}];return(0,r.jsx)(K._z,{children:(0,r.jsx)(W.Z,{headerTitle:(E==null?void 0:E.name)||"\u6D41\u7A0B\u8FD0\u884C\u5B9E\u4F8B\u5217\u8868",params:{processDefinitionId:E==null?void 0:E.processDefinitionId},request:z,search:!1,scroll:{y:600},columns:S(i).concat(re),pagination:!1,rowKey:"processInstanceId",actionRef:n})})}}}]);
